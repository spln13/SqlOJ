# 关于题库和竞赛

## 题库

- 题库中包含若干基础习题，设置可见或者不可见，或者设置公布时间。(一般是可见)
- 题目中不包含测试样例
- 可由学生出题，老师与管理员对题目进行审核
- 题库系统设置排行榜，通过积分进行排名。机制如下:`easy: 3分; medium: 7分; hard: 15分`

## 竞赛

1. 作业和课堂练习统一采用竞赛的模式。
2. 初始化竞赛时需要指定参与的班级, 竞赛开始时间， 持续时间，以及包含的习题。
3. 包含的习题须由出题人从题库中选定，被选中的习题生成习题副本,提交记录全部指向此习题副本。
4. 竞赛开始时，被引用的题目无法被竞赛用户查看。
5. 竞赛设置竞赛排行榜，采用罚时机制。如: 一次未通过罚时1min，最后通过通过题数以及用时数排名。

### 创建竞赛

教师从题库中选择题目，设置开始时间、持续时长、竞赛名字、勾选参与的班级。

关于参与竞赛用户无法查看竞赛引用题目功能由Redis实现。使用以竞赛ID为键值的Set数据结构，Set中包括参与竞赛的学生ID。

设置该Set生效时间为竞赛开始时间，设置该Set过期时间为竞赛开始时间+竞赛持续时间。统一使用UTC。
这种方式也可以实现控制用户对竞赛对权限。

关于参与竞赛用户无法查看竞赛引用题目功能由Redis实现。使用以竞赛ID为键值的Set数据结构，Set中包括参与竞赛的学生ID。

为了方便统计学生做题情况，排除学生之前对此题对提交记录，需要对题库中引用对题目生成副本题目。
即在竞赛题库表中插入该题目，并设置单独的竞赛提交记录表。

关于排行榜，MySQL中加入`competition_result`表, 采用罚时机制，拥有`user_Id`, `contest_id`, `total_time`, 根据`total_time`排序。